shape = abs(Residuals) > 0+2*sd(Residuals))) +
geom_hline(yintercept = mean(x_re$Residuals), color="green")
grid.arrange(
ggplot(data = fir_40) + geom_point(mapping = aes(x = x1,y = y))
+ geom_line(mapping =
aes(x = x1,y = model$coefficients[1]+model$coefficients[2]*x1^2+model$coefficients[3]*x1^3,
colour = "The Contribution \n of X1"),size = 1)
+ geom_smooth(mapping = aes(x = x1,y = y,colour = "Smooth Fitted"))
,ggplot(data = fir_40) + geom_point(mapping = aes(x = x2,y = y))
+ geom_line(mapping =
aes(x = x2,y = model$coefficients[1]+model$coefficients[4]*x2+model$coefficients[5]*x2^2,
colour = "The Contribution \n of X2"),size = 1)
+ geom_smooth(mapping = aes(x = x2,y = y, colour = "Smooth Fitted"))
,ncol = 1
)
mo_be = lm(courseevaluation ~ I(btystdave^3), data = beauty.data)
ggplot(data = beauty.data) +
geom_point(aes(x = btystdave,y = courseevaluation,
colour = "Original Value"), alpha = 1,size = 0.7) +
geom_line(aes(x = btystdave,y = 3.99066+ 0.08827 * btystdave^3, colour = "My Model"),size = 1) +
geom_smooth(aes(x = btystdave,y = courseevaluation,colour = "Smooth Fitted"), se = FALSE)
summary(mo_be)
mo_be = lm(courseevaluation ~ btystdave, data = beauty.data)
ggplot(data = beauty.data) +
geom_point(aes(x = btystdave,y = courseevaluation,
colour = "Original Value"), alpha = 1,size = 0.7) +
geom_line(aes(x = btystdave,y = 3.99066+ 0.08827 * btystdave, colour = "My Model"),size = 1) +
geom_smooth(aes(x = btystdave,y = courseevaluation,colour = "Smooth Fitted"), se = FALSE)
summary(mo_be)
cor = reshape2::melt(cor(da))
beauty.data <- read.table (paste0(gelman_example_dir,
"beauty/ProfEvaltnsBeautyPublic.csv"), header=T, sep=",")
mo_be = lm(courseevaluation ~ btystdave, data = beauty.data)
ggplot(data = beauty.data) +
geom_point(aes(x = btystdave,y = courseevaluation,
colour = "Original Value"), alpha = 1,size = 0.7) +
geom_line(aes(x = btystdave,y = 3.99066+ 0.08827 * btystdave, colour = "My Model"),size = 1) +
geom_smooth(aes(x = btystdave,y = courseevaluation,colour = "Smooth Fitted"), se = FALSE)
ggplot() + geom_point(aes(x = mo_be$fitted.values,y = mo_be$residuals)) +
geom_smooth(aes(x = mo_be$fitted.values,y = mo_be$residuals,colour = "lm Smooth"),
method = 'lm',se = FALSE) + ylab("Residuals") + xlab("Fitted Values")
summary(mo_be)
ggplot() + geom_point(aes(x = mo_be$fitted.values,y = mo_be$residuals)) +
geom_smooth(aes(x = mo_be$fitted.values,y = mo_be$residuals,colour = "lm Smooth"),
method = 'lm',se = FALSE) + ylab("Residuals") + xlab("Fitted Values")
da = cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$minority,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female,beauty.data$formal,beauty.data$lower)
colnames(da) = c("tenured","Beauty Rate","minority","age","evaluation","female","formal","lower")
kable(cor(da),digits = 3, align = "c")
cor = reshape2::melt(cor(da))
ggplot(data = cor, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + scale_fill_gradient2(name="Value",
low = "darkgreen",high = "red", mid = "white")
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
summary(m)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
car::marginalModelPlots(m,col=rgb(0,0,0,alpha=0.3),col.line = c("green","red"),
fitted = FALSE,grid = FALSE)
car::avPlots(m, id.n=0, id.cex=0.6,grid = FALSE)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) + geom_point(aes(y = evaluation,x = tenured)),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) + geom_point(aes(y = evaluation,x = female)),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) + geom_point(aes(y = evaluation,x = tenured)),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) + geom_point(aes(y = evaluation,x = female)),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = dad)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) + geom_point(aes(y = evaluation,x = tenured)),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) + geom_point(aes(y = evaluation,x = female)),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) + geom_boxplot(aes(x = tenured)),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) + boxplot(aes(x = female)),
ncol = 2
)
ggplot(dad) + geom_boxplot(aes(x = tenured))
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) + geom_boxplot(aes(y = evaluation,x = tenured)),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) + boxplot(aes(y = evaluation,x = female)),
ncol = 2
)
ggplot(dad) + geom_boxplot(aes(y = evaluation,x = tenured))
library(esquisse)
esquisser(dad)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(tenured), scales = "free"),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(female), scales = "free"),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(tenured), scales = "free"),
ggplot(dad) + geom_point(aes(y = evaluation,x = Beauty_Rate)),
ggplot(dad) + geom_point(aes(y = evaluation,x = age)),
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(female), scales = "free"),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(tenured), scales = "free"),
ggplot(dad,aes(y = evaluation,x = Beauty_Rate))
+ geom_point()
+ geom_smooth(),
ggplot(dad,aes(y = evaluation,x = age))
+ geom_point()
+ geom_smooth(),
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(female), scales = "free"),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(tenured), scales = "free"),
ggplot(dad,aes(y = evaluation,x = Beauty_Rate))
+ geom_point()
+ geom_smooth(),
ggplot(dad,aes(y = evaluation,x = age))
+ geom_point(se = FALSE)
+ geom_smooth(se = FALSE),
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(female), scales = "free"),
ncol = 2
)
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
m = lm(evaluation ~ tenured+Beauty_Rate+age+female,data = data.frame(dad))
grid.arrange(
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(tenured), scales = "free") + xlab("tenured"),
ggplot(dad,aes(y = evaluation,x = Beauty_Rate))
+ geom_point()
+ geom_smooth(),
ggplot(dad,aes(y = evaluation,x = age))
+ geom_point(se = FALSE)
+ geom_smooth(se = FALSE),
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(female), scales = "free")+ xlab("female"),
ncol = 2
)
m = lm(evaluation ~ Beauty_Rate+I(Beauty_Rate^2)+age,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ Beauty_Rate+I(Beauty_Rate^3)+age,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ I(Beauty_Rate^3)+age,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+age,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+age+female,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+age+female,female:Beauty_Rate,female:age,data = data.frame(dad))
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+age+female,female*Beauty_Rate,female*age,data = data.frame(dad))
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+age+female,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+female,data = data.frame(dad))
summary(m)
m = lm(evaluation ~ I(Beauty_Rate)+I(Beauty_Rate^2)+I(Beauty_Rate^3)+female,data = data.frame(dad))
summary(m)
View(beauty.data)
View(dad)
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+I(female*Beauty_Rate)+female,data = data.frame(dad))
summary(m)
pred = data.frame(cbind(as.matrix(cbind(1,pyth[41:60,2]^2,pyth[41:60,3],
pyth[41:60,3]^2)) %*% matrix(model$coefficients,ncol = 1),pyth[41:60,2:3]))
pred = data.frame(cbind(as.matrix(cbind(1,pyth[41:60,2]^2,pyth[41:60,3],
pyth[41:60,3]^2)) %*% matrix(model$coefficients,ncol = 1),pyth[41:60,2:3]))
pred = model$coefficients[1]+model$coefficients[2]*fir_40$x1^2+model$coefficients[3]*fir_40$x1^3+
model$coefficients[4]*fir_40$x2+model$coefficients[5]*fir_40$x2^2
colnames(pred) = c('pred','x1','x2')
pred = model$coefficients[1]+model$coefficients[2]*fir_40$x1^2+model$coefficients[3]*fir_40$x1^3+
model$coefficients[4]*fir_40$x2+model$coefficients[5]*fir_40$x2^2
pred = cbind(pred,fir_40$x1,fir_40$x2)
colnames(pred) = c('pred','x1','x2')
pe1 = ggplot(pred) + geom_point(aes(x = x1,y = pred))
pred = model$coefficients[1]+model$coefficients[2]*fir_40$x1^2+model$coefficients[3]*fir_40$x1^3+
model$coefficients[4]*fir_40$x2+model$coefficients[5]*fir_40$x2^2
pred = cbind(pred,fir_40$x1,fir_40$x2)
pred = data.frame(pred)
colnames(pred) = c('pred','x1','x2')
pe1 = ggplot(pred) + geom_point(aes(x = x1,y = pred))
pe2 = ggplot(pred) + geom_point(aes(x = x2,y = pred))
grid.arrange(pe1,pe2,ncol = 1)
pred = model$coefficients[1]+model$coefficients[2]*pyth$x1^2+model$coefficients[3]*pyth$x1^3+
model$coefficients[4]*pyth$x2+model$coefficients[5]*pyth$x2^2
pred = cbind(pred,pyth$x1,pyth$x2)
pred = data.frame(pred)
colnames(pred) = c('pred','x1','x2')
pe1 = ggplot(pred) + geom_point(aes(x = x1,y = pred))
pe2 = ggplot(pred) + geom_point(aes(x = x2,y = pred))
grid.arrange(pe1,pe2,ncol = 1)
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
qqPlot(m$residuals)
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
qqPlot(m$residuals,envelope = 0.95)
par(mfrow=c(1,2))
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
qqPlot(m$residuals,envelope = 0.95)
grid.arrange(
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
,qqPlot(m$residuals,envelope = 0.95)
,ncol = 2
)
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
qqPlot(m$residuals,envelope = 0.95)
var1 <- rnorm(1000,0,1)
var2 <- rnorm(1000,0,1)
var1 <- rnorm(1000,0,1)
var2 <- rnorm(1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores <- coef(fit)[2]/se.coef(fit)[2]
z.scores
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
sum(z.scores>2)
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
sum(z.scores>2)
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
sum(z.scores>2)
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
sum(z.scores>2)
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
sum(z.scores>2)
z.scores <- rep (NA, 100)
for (k in 1:100) {
var1 <- rnorm (1000,0,1)
var2 <- rnorm (1000,0,1)
fit  <- lm (var2 ~ var1)
z.scores[k] <- coef(fit)[2]/se.coef(fit)[2]
}
sum(z.scores>2)
fox_data_dir<-"http://socserv.socsci.mcmaster.ca/jfox/Books/Applied-Regression-3E/datasets/"
Prestige<-read.table(paste0(fox_data_dir,"Prestige.txt"))
kable(head(Prestige))
fox_data_dir<-"http://socserv.socsci.mcmaster.ca/jfox/Books/Applied-Regression-3E/datasets/"
Prestige<-read.table(paste0(fox_data_dir,"Prestige.txt"))
kable(head(Prestige))
st1 = lm(prestige~women+income,data = Prestige)
st2 = lm(education~income+women,data = Prestige)
st3 = lm(st1$residual~st2$residual)
rl = lm(prestige~education+women+income,data = Prestige)
st3$coefficient[2] - rl$coefficient[2]
fox_data_dir<-"http://socserv.socsci.mcmaster.ca/jfox/Books/Applied-Regression-3E/datasets/"
Prestige<-read.table(paste0(fox_data_dir,"Prestige.txt"))
kable(head(Prestige))
st1 = lm(prestige~women+income,data = Prestige)
st2 = lm(education~income+women,data = Prestige)
st3 = lm(st1$residual~st2$residual)
rl = lm(prestige~education+women+income,data = Prestige)
st3$coefficient[2]
rl$coefficient[2]
cor(st1$residual,st2$residual)
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+I(female*Beauty_Rate)+female,data = data.frame(dad))
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
beauty.data <- read.table (paste0(gelman_example_dir,
"beauty/ProfEvaltnsBeautyPublic.csv"), header=T, sep=",")
pacman::p_load(ggplot2, knitr, arm, data.table,Cairo,gridExtra,tinytex)
knitr::opts_chunk$set(echo = TRUE,dev="CairoPNG",fig.align = "center", message = FALSE,tidy = TRUE,
fig.width = 7, fig.height = 4, global.par = TRUE, warning = FALSE)
par (mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
gelman_example_dir<-"http://www.stat.columbia.edu/~gelman/arm/examples/"
pyth <- read.table (paste0(gelman_example_dir,"pyth/exercise2.1.dat"),
header=T, sep=" ")
beauty.data <- read.table (paste0(gelman_example_dir,
"beauty/ProfEvaltnsBeautyPublic.csv"), header=T, sep=",")
mo_be = lm(courseevaluation ~ btystdave, data = beauty.data)
ggplot(data = beauty.data) +
geom_point(aes(x = btystdave,y = courseevaluation,
colour = "Original Value"), alpha = 1,size = 0.7) +
geom_line(aes(x = btystdave,y = 3.99066+ 0.08827 * btystdave, colour = "My Model"),size = 1) +
geom_smooth(aes(x = btystdave,y = courseevaluation,colour = "Smooth Fitted"), se = FALSE)
summary(mo_be)
ggplot() + geom_point(aes(x = mo_be$fitted.values,y = mo_be$residuals)) +
geom_smooth(aes(x = mo_be$fitted.values,y = mo_be$residuals,colour = "lm Smooth"),
method = 'lm',se = FALSE) + ylab("Residuals") + xlab("Fitted Values")
cor = reshape2::melt(cor(da))
da = cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$minority,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female,beauty.data$formal,beauty.data$lower)
colnames(da) = c("tenured","Beauty Rate","minority","age","evaluation","female","formal","lower")
kable(cor(da),digits = 3, align = "c")
cor = reshape2::melt(cor(da))
ggplot(data = cor, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + scale_fill_gradient2(name="Value",
low = "darkgreen",high = "red", mid = "white")
dad=cbind(beauty.data$tenured,beauty.data$btystdave,beauty.data$age,
beauty.data$courseevaluation,beauty.data$female)
colnames(dad) = c("tenured","Beauty_Rate","age","evaluation","female")
dad=data.frame(dad)
grid.arrange(
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(tenured), scales = "free") + xlab("tenured"),
ggplot(dad,aes(y = evaluation,x = Beauty_Rate))
+ geom_point()
+ geom_smooth(),
ggplot(dad,aes(y = evaluation,x = age))
+ geom_point(se = FALSE)
+ geom_smooth(se = FALSE),
ggplot(dad) +aes(x = "", y = evaluation) +geom_boxplot(fill = "#0c4c8a") +
theme_minimal() +facet_wrap(vars(female), scales = "free")+ xlab("female"),
ncol = 2
)
m = lm(evaluation ~ I(Beauty_Rate^2)+I(Beauty_Rate^3)+I(female*Beauty_Rate)+female,data = data.frame(dad))
summary(m)
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
qqPlot(m$residuals,envelope = 0.95)
var1 <- rnorm(1000,0,1)
var2 <- rnorm(1000,0,1)
var1 <- rnorm(1000,0,1)
var2 <- rnorm(1000,0,1)
ggplot() + geom_point(aes(x = m$fitted.values,y = m$residuals)) +
ylab("Residuals") + xlab("Fitted Values")
qqPlot(m$residuals,envelope = 0.95)
?log
1. Give the equation of the regression line and the residual standard deviation of the regression.
$\ln(Earning)=\beta_0+\beta_1*\ln(height)+\varepsilon$, we can rearrange this equation and we can get $Earning=e^{\beta_0}*Hight^{\beta_1}*\varepsilon$,increase height by 1% means that multiply height by 1.01, which equals to multiply the right-hand side by $1.01^{\beta_1}$, so we can deduce that $1.01^{\beta_1}=1.008$, so $\beta_1=\log_{1.01}1.008=$ `r log(1.008,1.01)`,and we also know that a person who is 66 inches is predicted to have earnings of 30000, which means$ln(30000)=\beta_0+\beta_1*ln(66)$, so we can plug $\beta_1=$ `r log(1.008,1.01)`, we obtain $\beta_0=\ln(30000)-\ln(66)*\beta_1=$ `r log(30000) - log(66)*log(1.008,1.01)`
library(ggplot2)
data(mpg)
mpg_1 = select(mpg,cty,hwy,class)
data(mpg)
data(mpg)
data(mpg)
mpg_1 = select(mpg,cty,hwy,class)
force(mpg)
mpg_1 %<>% group_by(class) %>%
summarise(City = mean(sty),Highway = mean(hwy)) %>%
arrange(class, City,Highway)
library(dplyr)
install.packages("dplyr")
mpg_1 %<>% group_by(class) %>%
summarise(City = mean(sty),Highway = mean(hwy)) %>%
arrange(class, City,Highway)
library(dplyr)
mpg = data(mpg)
mpg_1 = select(mpg,cty,hwy,class)
mpg_1 %<>% group_by(class) %>%
summarise(City = mean(sty),Highway = mean(hwy)) %>%
arrange(class, City,Highway)
mpg = data(mpg)
mpg_1 = select(mpg,cty,hwy,class)
mpg_1 = Select(mpg,cty,hwy,class)
library(dplyr)
mpg = data(mpg)
mpg_1 = Select(mpg,cty,hwy,class)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
mpg = data(mpg)
mpg_1 = Select(mpg,cty,hwy,class)
mpg_1 = select(mpg,cty,hwy,class)
data(mpg)
mpg_1 = select(mpg,cty,hwy,class)
mpg_1 %<>% group_by(class) %>%
summarise(City = mean(sty),Highway = mean(hwy)) %>%
arrange(class, City,Highway)
mpg_1 %<>% group_by(class) %>%
summarise(City = mean(cty),Highway = mean(hwy)) %>%
arrange(class, City,Highway)
mpg_1
mpg_1 %<>% group_by(class)
library(tidyverse)
data(mpg)
mpg_1 = select(mpg,cty,hwy,class)
mpg_1 %<>% group_by(class)
mpg_1 %<>% group_by(class) %>%
summarise(City = mean(cty),Highway = mean(hwy)) %>%
arrange(class, City,Highway)
mpg_1 = select(mpg,cty,hwy,class)
mpg_1 %>% group_by(class)
mpg_1 %>% group_by(class) %>% mpg_2
mpg_2 = mpg_1 %>% group_by(class)
View(mpg_2)
?summarise
mpg_1 %>% group_by(class) %>%
mpg_1 %>% group_by(class) %>% group_by(class)
mpg_1 = select(mpg,cty,hwy,class)
mpg_1 %>% group_by(class) %>% group_by(class)
pacman::p_load(ggplot2, knitr, arm, data.table,Cairo,gridExtra,tinytex)
knitr::opts_chunk$set(echo = TRUE,dev="CairoPNG",fig.align = "center", message = FALSE,tidy = TRUE,
fig.width = 7, fig.height = 4, global.par = TRUE, warning = FALSE)
par (mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
cor(st1$residual,st2$residual)
fox_data_dir<-"http://socserv.socsci.mcmaster.ca/jfox/Books/Applied-Regression-3E/datasets/"
Prestige<-read.table(paste0(fox_data_dir,"Prestige.txt"))
kable(head(Prestige))
st1 = lm(prestige~women+income,data = Prestige)
st2 = lm(education~income+women,data = Prestige)
st3 = lm(st1$residual~st2$residual)
rl = lm(prestige~education+women+income,data = Prestige)
st3$coefficient[2]
rl$coefficient[2]
cor(st1$residual,st2$residual)
