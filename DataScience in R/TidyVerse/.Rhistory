ka2 = cbind(te[37:48,c(1,3,4)],te[49:60,c(3,4)])
kable(ka1, caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position"))
# kable(GDP[,13:24], caption = "Total GDP for each continents 1972-1987", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1972"=3,"1977"=3,
#                                                                          "1982"=3,"1987"=3))
# kable(GDP[,25:36], caption = "Total GDP for each continents 1992-2007", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1992"=3,"1997"=3,
#                                                                          "2002"=3,"2007"=3))
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1, caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position"))
# kable(GDP[,13:24], caption = "Total GDP for each continents 1972-1987", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1972"=3,"1977"=3,
#                                                                          "1982"=3,"1987"=3))
# kable(GDP[,25:36], caption = "Total GDP for each continents 1992-2007", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1992"=3,"1997"=3,
#                                                                          "2002"=3,"2007"=3))
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position"))
# kable(GDP[,13:24], caption = "Total GDP for each continents 1972-1987", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1972"=3,"1977"=3,
#                                                                          "1982"=3,"1987"=3))
# kable(GDP[,25:36], caption = "Total GDP for each continents 1992-2007", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1992"=3,"1997"=3,
#                                                                          "2002"=3,"2007"=3))
View(ka1)
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=,"Asia"=3))
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=2,"Asia"=2))
# kable(GDP[,13:24], caption = "Total GDP for each continents 1972-1987", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1972"=3,"1977"=3,
#                                                                          "1982"=3,"1987"=3))
# kable(GDP[,25:36], caption = "Total GDP for each continents 1992-2007", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1992"=3,"1997"=3,
#                                                                          "2002"=3,"2007"=3))
View(te)
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
colnames(te)=c("","Continent","Total Population","GDP Per Capita")
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=2,"Asia"=2))
# kable(GDP[,13:24], caption = "Total GDP for each continents 1972-1987", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1972"=3,"1977"=3,
#                                                                          "1982"=3,"1987"=3))
# kable(GDP[,25:36], caption = "Total GDP for each continents 1992-2007", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1992"=3,"1997"=3,
#                                                                          "2002"=3,"2007"=3))
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
colnames(te)=c("Year","Continent","Total Population","GDP Per Capita")
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=2,"Asia"=2))
# kable(GDP[,13:24], caption = "Total GDP for each continents 1972-1987", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1972"=3,"1977"=3,
#                                                                          "1982"=3,"1987"=3))
# kable(GDP[,25:36], caption = "Total GDP for each continents 1992-2007", align = "c", booktab =T, format = "latex",longtable = F) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("1992"=3,"1997"=3,
#                                                                          "2002"=3,"2007"=3))
View(ka2)
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
colnames(te)=c("Year","Continent","Total Population","GDP Per Capita")
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=2,"Asia"=2))
kable(ka2[,c(1,3,4,7,8)], caption = "Total Population and GDP per Capita", align = "c", booktab =T) %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Europe"=2,"Oceania"=2))
View(Summary_1952)
View(Summary_2007)
Summary=rbind(Summary_1952,Summary_2007)
View(Summary)
library(DSR)
library(tidyr)
table2
spread(table2,key = key, value = value)
pivot_wider(table2,names_from = type, values_from = count)
table4
gather(table4,"year","cases",2:3)
View(Summary)
Summary %<>% gather("Value",2:5)
Summary = gather(Summary,"Value",2:5)
View(Summary)
Summary %<>% pivot_longer(2:5,names_to = "value")
View(Summary)
Summary = pivot_longer(Summary,2:5,names_to = "value")
Summary = pivot_longer(Summary,cols=c(Ave_GDP_capita,Max_GDP_capita,Min_GDP_capita,var_GDP_capita),names_to = "value")
Summary = reshape2::melt(Summary)
View(Summary)
Summary=rbind(Summary_1952,Summary_2007)
View(Summary)
esquisse::esquisser(Summary_1952)
Summary_1952 = reshape2::melt(Summary_1952)
Summary_2007 = reshape2::melt(Summary_2007)
View(Summary_1952)
Summary_1952 = da %>% filter(year == 1952) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
kable(Summary_1952, caption = "Summary for GDP per Capita in 1952", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position"))
Summary_2007 = da %>% filter(year == 2007) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
View(Summary_1952)
Summary_1952 = reshape2::melt(Summary_1952)
Summary_2007 = reshape2::melt(Summary_2007)
esquisse::esquisser(Summary_1952)
plot(Summary_1952)
plot(reshape2::melt(Summary_1952[1,]))
plot(Summary_1952[1,])
plot(t(Summary_1952[1,]))
plot(t(as.matrix(Summary_1952[1,])))
Summary_1952[1,]
Summary_1952 = da %>% filter(year == 1952) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
plot(t(as.matrix(Summary_1952[1,])))
plot(t(as.matrix(Summary_1952[1,])),type = "l")
esquisse::esquisser(Summary_1952)
ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita") +
theme_ipsum_rc()
ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita") +
theme_ipsum_rc()
ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
ggplot(Summary_1952) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
ggplot(Summary_1952) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
ggplot(Summary_1952) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
ggplot(Summary_1952) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
a1=ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_1952) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_1952) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_1952) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
esquisse::esquisser(Summary_1952)
esquisse::esquisser(Summary_1952)
esquisse::esquisser(Summary_1952)
a1=ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_1952) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_1952) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_1952) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
a1=ggplot(Summary_) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a1=ggplot(Summary_2007) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_2007) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_2007) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_2007) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
View(Summary_2007)
Summary_2007 = da %>% filter(year == 2007) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
a1=ggplot(Summary_2007) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_2007) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_2007) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_2007) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
knitr::opts_chunk$set(echo = F,warning = F)
pacman::p_load("tidyverse","knitr","kableExtra","gapminder","magrittr")
da = gapminder
Num_of_continent = da$continent %>% unique %>% length
Num_of_contries = da$country %>% unique %>% length
con_per = da %>% group_by(continent) %>% summarise( Num_of_contries = country %>% unique %>% length) %>% arrange(Num_of_contries , continent)
kable(con_per, caption = "Number of countries included for each cintinents", align = "c", booktab =T, format = "latex",longtable = T) %>% kable_styling(latex_options = "hold_position")
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
colnames(te)=c("Year","Continent","Total Population","GDP Per Capita")
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,format = "latex") %>% kable_styling(latex_options = c("HOLD_position","scale_down")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=2,"Asia"=2))
kable(ka2[,c(1,3,4,7,8)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,format = "latex") %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Europe"=2,"Oceania"=2))
Summary_1952 = da %>% filter(year == 1952) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
kable(Summary_1952, caption = "Summary for GDP per Capita in 1952", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position"))
Summary_2007 = da %>% filter(year == 2007) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
kable(Summary_2007, caption = "Summary for GDP per Capita in 2007", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position","scale_down"))
a1=ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_1952) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_1952) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_1952) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
a1=ggplot(Summary_2007) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_2007) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_2007) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_2007) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
neg_inc =  da %>% group_by(country) %>% summarise(t = sum(diff(pop)>0), l = length(pop), n = 11-t) %>% filter(t<11) %>% arrange(n)
colnames(neg_inc) = c("Country","","","# of year of negative pop growth")
neg_inc = cbind(neg_inc[1:9,],neg_inc[10:18,],neg_inc[19:27,])
kable(neg_inc[,c(1,4,5,8,9,12)], caption = "Countries had periods of negative population growth", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position")) %>% column_spec(c(1,2,3,4,5,6),width = "7em")
View(da)
da$'Log_gdpC' = log(da$gdpPercap)
View(da)
tt = da %>% group_by(country) %>% summarise(Max_GR = max(diff(Log_gdpC)))
View(tt)
order(tt,decreasing = T)
order(tt,decreasing = TRUE)
tt = da %>% group_by(country) %>% summarise(Max_GR = max(diff(Log_gdpC))) %>% arrange(Max_GR)
tt = da %>% group_by(country) %>% summarise(Max_GR = max(diff(Log_gdpC))) %>% arrange(desc(Max_GR))
da$'Log_gdpC' = log(da$gdpPercap)
tt = da %>% group_by(country) %>% summarise(Max_GR = max(diff(Log_gdpC))) %>% arrange(desc(Max_GR))
print(tt[1,])
da$'Log_gdpC' = log(da$gdpPercap)
tt = da %>% group_by(country) %>% summarise(Max_GR = max(diff(Log_gdpC))) %>% arrange(desc(Max_GR))
kable(tt[1,])
knitr::opts_chunk$set(echo = F,warning = F,fig.height = 4)
pacman::p_load("tidyverse","knitr","kableExtra","gapminder","magrittr")
da = gapminder
Num_of_continent = da$continent %>% unique %>% length
Num_of_contries = da$country %>% unique %>% length
con_per = da %>% group_by(continent) %>% summarise( Num_of_contries = country %>% unique %>% length) %>% arrange(Num_of_contries , continent)
kable(con_per, caption = "Number of countries included for each cintinents", align = "c", booktab =T, format = "latex",longtable = T) %>% kable_styling(latex_options = "hold_position")
te = da %>% group_by(year,continent) %>% summarise(tol_POP = sum(as.numeric(pop)),GDP_perCap = sum(pop*gdpPercap)/tol_POP) %>% arrange(continent)
colnames(te)=c("Year","Continent","Total Population","GDP Per Capita")
ka1 = cbind(te[1:12,],te[13:24,],te[25:36,])
ka2 = cbind(te[37:48,],te[49:60,])
kable(ka1[,c(1,3,4,7,8,11,12)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,format = "latex") %>% kable_styling(latex_options = c("HOLD_position","scale_down")) %>% add_header_above(c("Year"=1,"Africa"=2,"American"=2,"Asia"=2))
kable(ka2[,c(1,3,4,7,8)], caption = "Total Population and GDP per Capita", align = "c", booktab =T,format = "latex") %>% kable_styling(latex_options = c("HOLD_position")) %>% add_header_above(c("Year"=1,"Europe"=2,"Oceania"=2))
Summary_1952 = da %>% filter(year == 1952) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
kable(Summary_1952, caption = "Summary for GDP per Capita in 1952", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position"))
Summary_2007 = da %>% filter(year == 2007) %>% group_by(continent) %>% summarise(Ave_GDP_Capita = mean(gdpPercap),
Max_GDP_Capita = max(gdpPercap),
Min_GDP_Capita = min(gdpPercap),
var_GDP_Capita = var(gdpPercap)) %>% arrange(Ave_GDP_Capita)
kable(Summary_2007, caption = "Summary for GDP per Capita in 2007", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position","scale_down"))
a1=ggplot(Summary_1952) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_1952) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_1952) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_1952) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
a1=ggplot(Summary_2007) +
aes(x = continent, weight = Ave_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Ave_GDP_Capita")
a2=ggplot(Summary_2007) +
aes(x = continent, weight = Max_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Max_GDP_Capita")
a3=ggplot(Summary_2007) +
aes(x = continent, weight = Min_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Min_GDP_Capita")
a4=ggplot(Summary_2007) +
aes(x = continent, weight = var_GDP_Capita) +
geom_bar(fill = "#0c4c8a") +
labs(y = "Variance_GDP_Capita")
gridExtra::grid.arrange(a1,a2,a3,a4,ncol=2)
neg_inc =  da %>% group_by(country) %>% summarise(t = sum(diff(pop)>0), l = length(pop), n = 11-t) %>% filter(t<11) %>% arrange(n)
colnames(neg_inc) = c("Country","","","# of year of negative pop growth")
neg_inc = cbind(neg_inc[1:9,],neg_inc[10:18,],neg_inc[19:27,])
kable(neg_inc[,c(1,4,5,8,9,12)], caption = "Countries had periods of negative population growth", align = "c", booktab =T, format = "latex") %>%
kable_styling(latex_options = c("HOLD_position")) %>% column_spec(c(1,2,3,4,5,6),width = "7em")
da$'Log_gdpC' = log(da$gdpPercap)
tt = da %>% group_by(country) %>% summarise(Max_GR = max(diff(Log_gdpC))) %>% arrange(desc(Max_GR))
kable(tt[1:10,],format = "latex",booktab=T,align = "c",caption = "Log Growth Rate") %>% kable_styling(latex_options = "HOLD_position")
library(AER)
data("Fertility")
daa = Fertility
c = daa %>% group_by(gender1,gender2) %>% summarise(count = length(age))
c$"prop" = c$count/sum(c$count)
c1 = ggplot(c,aes(y = gender1,x = gender2,fill = count)) + geom_tile()+geom_text(aes(label = count)) +
scale_fill_gradient(low = "white", high = "red") + theme(legend.position = "") + ggtitle("Counts for four combinations")
c2 = ggplot(c,aes(y = gender1,x = gender2,fill = prop)) + geom_tile()+ geom_tile()+geom_text(aes(label = round(prop,2))) +
scale_fill_gradient(low = "white", high = "red")  + theme(legend.position = "")+ ggtitle("Proportion for four combinations")
gridExtra::grid.arrange(c1,c2,ncol=2)
c29 = daa %>% filter(age>29) %>% group_by(gender1,gender2) %>% summarise(count = length(age))
c29$"prop" = c$count/sum(c$count)
c30 = daa %>% filter(age>30) %>% group_by(gender1,gender2) %>% summarise(count = length(age))
c30$"prop" = c$count/sum(c$count)
cc29 = ggplot(c29,aes(y = gender1,x = gender2,fill = count)) + geom_tile()+geom_text(aes(label = count)) +
scale_fill_gradient(low = "white", high = "red") + theme(legend.position = "")+ ggtitle("Age before 30")
cc30 = ggplot(c30,aes(y = gender1,x = gender2,fill = count)) + geom_tile()+geom_text(aes(label = count)) +
scale_fill_gradient(low = "white", high = "red") + theme(legend.position = "")+ ggtitle("Age after 30")
gridExtra::grid.arrange(cc29,cc30,ncol=2)
e = daa %>% group_by(afam,hispanic,other) %>% summarise(count=sum(morekids=="no"))
e = e[c(1,2,3,5),]
e$"Ethnicity" = c("Caucasian","None","hispanish","African-American")
e$"frequency" = e$count/sum(e$count)
library(ggplot2)
ggplot(e) +
aes(x = Ethnicity, weight = frequency) +
geom_bar(fill = "#0c4c8a") +
theme_minimal() + ylab("Frequency of having more than two kids")
data("mtcars")
force(mtcars)
View(mtcars)
q4 = sum(str_detect(rownames(mtcars),"Merc"))
rr rownames(mtcars)
rr = rownames(mtcars)
rr[1]
str_count(rr,"e")
q3 = sum(str_count(rownames(mtcars),"e"))
data(mpg)
force(mpg)
View(mpg)
data(mpg)
q5 = sum(str_detect(mpg$manufacturer,"Merc"))
q5 = sum(str_detect(mpg$manufacturer,"merc"))
install.packages("babynames")
library(babynames)
data("babynames")
force(babynames)
View(babynames)
R_in = sample(1:length(babynames),500000,replace = F)
length(babynames)
R_in = sample(1:length(babynames[,1]),500000,replace = F)
length(babynames[,1]
length(babynames[,1])
babynames[,1]
R_in = sample(1:1924665,500000,replace = F)
R_in
sam_da = babynames[R_in,]
sam_da %>% filter(year == c(1880,1920,1960,2000))
sam_da %>% filter(year == c(1880,1920,1960,2000)) %>% group_by(year,sex) %>% arrange(n)
View(sam_da)
View(sam_da)
View(sam_da)
y = c(1880,1920,1960,2000)
se = c("F","M")
re = NULL
for(i in y){
for(j in se){
a = filter(sam_da,year==i,sex==j) %>% arrange(desc(n))
a[1:5,]
re=rbind(re,as.matrix(a))
}
}
View(re)
debugSource('D:/R-connect-Server/DataScience in R HW/TidyVerse/Debug File.R', echo=TRUE)
y = c(1880,1920,1960,2000)
se = c("F","M")
re = NULL
for(i in y){
for(j in se){
a = filter(sam_da,year==i,sex==j) %>% arrange(desc(n))
re=rbind(re,as.matrix(a[1:5,]))
}
}
View(re)
sam_da %>% group_by(year,names) %>% summarise(cou = n(sex))
sam_da %>% group_by(year,name) %>% summarise(cou = n(sex))
sam_da %>% group_by(year,name) %>% summarise(cou = length(sex))
sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou))
sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou)) %>% select(name,cou)
filter(sam_da,year==1880,name=="Claude")
hh = sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou))
unique(hh$name)
hh = sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou))
length(unique(hh$name))
class(sam_da$year)
l1 = sam_da %>% filter(year>1999)
l1 = unique(l1$name)
l1 = sam_da %>% filter(year>1999)
l1 = unique(l1$name)
l2 = sam_da %>% filter(year<1900)
l2 = unique(l2$name)
intersect(l1,l2)
sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n))
sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n)) %>% filter(name == c("Donald", "Hilary", "Hillary", "Joe", "Barrack")) %>% group_by(name) %>% summarise(co = sum(co))
filter(sam_da,name=="Barrack")
ree = sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n)) %>% filter(name == c("Donald", "Hilary", "Hillary", "Joe", "Barrack")) %>% group_by(name) %>% summarise(co = sum(co))
kable(ree)
ree = sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n)) %>% filter(name == c("Donald", "Hilary", "Hillary", "Joe", "Barrack")) %>% group_by(name) %>% summarise(frequency = sum(co))
kable(ree)
ree = sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n)) %>% filter(name == c("Donald", "Hilary", "Hillary", "Joe", "Barrack")) %>% group_by(name) %>% summarise(count = sum(co))
ree$"frequency" = ree$count / sum(ree$count)
kable(ree)
ree = sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n)) %>% filter(name == c("Donald", "Hilary", "Hillary", "Joe", "Barrack")) %>% group_by(name) %>% summarise(count = sum(co))
ree$"frequency" = round(ree$count / sum(ree$count),2)
kable(ree)
View(hh)
hh = sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou)) %>% filter(cou>1)
length(unique(hh$name))
hh = sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou)) %>% filter(cou>1)
unique(hh$name)[1:10]
l1 = sam_da %>% filter(year>1999)
l1 = unique(l1$name)
l2 = sam_da %>% filter(year<1900)
l2 = unique(l2$name)
Int = intersect(l1,l2)
l1 = sam_da %>% filter(year>1999)
l1 = unique(l1$name)
l2 = sam_da %>% filter(year<1900)
l2 = unique(l2$name)
Int = intersect(l1,l2)
Int[1:10]
ree = sam_da %>% filter(year >1879 & year <2018) %>% group_by(year,name) %>% summarise(co = sum(n)) %>%
filter(name == c("Donald", "Hilary", "Hillary", "Joe", "Barrack")) %>% group_by(name) %>% summarise(count = sum(co))
ree$"frequency" = round(ree$count / sum(ree$count),2)
hh = sam_da %>% group_by(year,name) %>% summarise(cou = length(sex)) %>% arrange(desc(cou)) %>%
filter(cou>1)
unique(hh$name)[1:10]
